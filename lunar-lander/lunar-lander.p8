pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
	game_over=false
	win=false
	
	g = 0.025 --gravity
	
	make_player()
	make_fuel()
	make_ground()
end

function _update()
	if(not game_over)then
		move_player()
		update_fuel()
		check_land()
	else
		if(btnp(5))then _init() end
	end
end

function _draw()
	cls() --clear screen
	draw_stars()
	draw_ground()
	draw_player()
	draw_fuel()
	
	if(game_over)then
		if(win) then
			print("you win!",48,48,11)
		else
			print("you crashed!", 38,48,8)
		end
			print("press ❎ to play again",20,70,5)
		end
end

function rndb(low,high)
	return flr(rnd(high-low+1)+low)
end

function check_land()
	l_x=flr(p.x) 		--left of ship
	r_x=flr(p.x+7) --right of ship
	b_y=flr(p.y+7) --bottom of ship
	--set truth gates
	over_pad=l_x>=pad.x and r_x <= pad.x+pad.width
	on_pad=b_y>=pad.y-1
	slow=p.dy<1
	--
	if(over_pad and on_pad 
				and slow)then
		end_game(true)
	elseif(over_pad and 
								on_pad)then
		end_game(false)
	else
		for i=l_x,r_x do
			if(gnd[i]<=b_y) end_game(false)
		end
	end
end

function end_game(won)
	game_over=true
	win=won
	
	if(win) then
		sfx(1)
		win_round(p)
	else
		sfx(2)
	end
end
-->8
function make_player()
	--player object
	p={}
	--
	--player position
	p.x =60
	p.y =8
	--
	--player movement
	p.dx =0
	p.dy =0
	--
	--extra config
	p.sprite =1
	p.alive = true
	p.thrust = 0.075
	p.score = 0
	--
end

function draw_player()
	spr(p.sprite,p.x,p.y)
	if(fuel>0) then
		if(btn(0) or btn(1) or btn(2))
			then 
			spr(6,p.x,p.y+8)
		end
	end
	
	if (game_over and win) then
		spr(4,p.x,p.y-8) --flag
	elseif(game_over)then
		spr(5,p.x,p.y) --exlosion
	end
end

function move_player()
	p.dy += g --add gravity
	if(fuel>0) then
		thrust()
	end
	
	p.x += p.dx --actually move
	p.y += p.dy --the player
	
	stay_on_screen()
end

function stay_on_screen()
	if(p.x < 0) then
		p.x=0
		p.dx=0
	end
	if (p.x > 119) then
		p.x=119
		p.dx=0
	end
	if (p.y < 0) then
		p.y=0
		p.dy=0
	end
end

function thrust()
	--add thrust to movement
	if(btn(0))then p.dx-=p.thrust end
	if(btn(1))then p.dx+=p.thrust end
	if(btn(2))then p.dy-=p.thrust end
	--thrust sound
	if(btn(0) or btn(1) or btn(2))
	then
		sfx(0)
	end
	if(btnp(0) or btnp(1) or btnp(2)) then
		hit+=.5
	end
end

function win_round(p)
	p.score+=1
end
-->8
function draw_stars()
	srand(1)
	for i=1,50 do
		pset(rndb(0,127),rndb(0,127),
			rndb(5,7))
	end
	srand(time())
end
-->8
function make_ground()
	--create the ground
	gnd={}
	local top = 96
	local btm = 120
	
	--set up the landing pad
	pad={}
	pad.width = 15
	pad.x=rndb(0,126-pad.width)
	pad.y=rndb(top,btm)
	pad.sprite=2
	
	--create ground at pad
	for i=pad.x, pad.x+pad.width do
		gnd[i]=pad.y
	end
	
	--create ground right of pad
	for i=pad.x+pad.width+1,127 do
		local h=rndb(gnd[i-1]-3,gnd[i-1]+3)
		gnd[i]=mid(top,h,btm)
	end
	
	--create ground left of pad
	for i=pad.x-1,0,-1 do
		local h=rndb(gnd[i+1]-3,gnd[i+1]+3)
		gnd[i]=mid(top,h,btm)
	end
end

function draw_ground()
	for i=0, 127 do
		line(i,gnd[i],i,127,5)
	end
	spr(pad.sprite,pad.x,pad.y,2,1)
end
-->8
function make_fuel()
	fuel=100
	hit=1
end

function update_fuel()
	if(fuel>0) then
		if(btn(0) or btn(1) or btn(2)) then
			fuel-=(1.25 * hit)
		end
	end
	barwidth=39*(fuel/100)+1
end

function draw_fuel()
	rect(120,40,127,0,6)
	rectfill(121,barwidth-1,126,1,3)
	if(fuel<0)then --due to calc
		print("fuel% 0")--lower than 0
	else													--is possible
		print("fuel% "..fuel)
	end
end
__gfx__
0000000000666600760dddddddddd766000000000088880008a77a80000000000000000000000000000000000000000000000000000000000000000000000000
00000000066c766076666666666666660000000008999980089aa980000000000000000000000000000000000000000000000000000000000000000000000000
0070070066ccc766007666666666660000006000899aa99808899880000000000000000000000000000000000000000000000000000000000000000000000000
0007700066cccc660000000000000000000b600089aa7a9800888800000000000000000000000000000000000000000000000000000000000000000000000000
0007700066555566000000000000000000bb600089aaaa9800888800000000000000000000000000000000000000000000000000000000000000000000000000
007007000666666000000000000000000bbb6000899aa99800088000000000000000000000000000000000000000000000000000000000000000000000000000
00000000050550500000000000000000000060000899998000088000000000000000000000000000000000000000000000000000000000000000000000000000
00000000660660660000000000000000000060000088880000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
33303030333030003030000033300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063333336
30003030300030000030000030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063333336
33003030330030000300000030300000007000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
30003030300030003000000030300000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000060000006
30000330333033303030000033300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
70000000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
07000000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00700000888800000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000060000006
07000000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
70000000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000070000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000700000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000050000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000000000000000060000006
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000066666666
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500060000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000
00000000000000000066660000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000
0000000000000000066c766000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000066ccc76600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000066cccc6600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000006655556670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000666666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000505505000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000
00000000000000006606606600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000050000000000000000
00000000000000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000050000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000060000000000000050000000000000000000000000000000000000050000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000060000000000000000000000000000000005000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000005000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000077000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00055000055555500000000000500000000000000000000000000000555505000000000000000000000000000000000000000000000000000000000000000000
05055550055555500050005555505765dddddddddd76605000500000555555000000000000000000000000000000000000000000000000000000000000000000
55555555055555555550075555555766666666666666605005550055555555000000000000000000000000000000000000500000000000000000000000000000
55555555555555555555555555555557666666666665555555550555555555550000000000000000000000000000000000500000000005555000000000000000
55555555555555555555555555555555555555555555555555555555555555555550000000000000000000000000000005500000005505555005005000000000
55555555555555555555555555555555555555555555555555555555555555555550000000000000000000000000000005550000005555555005505000000000
55555555555555555555555555555555555555555555555555555555555555555555000000500000000000000600000005550000005555555505505500000000
55555555555555555555555555555555555555555555555555555555555555555555005050500000000000000000005055550000055555555555555500000000
55555555555555555555555555555555555555555555555555555555555555555555505050550000000000000000005555555005055555555555555555550000
55555555555555555555555555555555555555555555555555555555555555555555505555555000000000000000055555555055055555555555555555550000
55555555555555555555555555555555555555555555555555555555555555555555555555555000000000000000055555555055555555555555555555550000
55555555555555555555555555555555555555555555555555555555555555555555555555555000000000000000055555555555555555555555555555555500
55555555555555555555555555555555555555555555555555555555555555555555555555555550000000000050555555555555555555555555555555555505
55555555555555555555555555555555555555555555555555555555555555555555555555555550000000055055555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555000000055555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555500505055555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555505555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555505555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

__sfx__
000600000e03000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000c00001b6701b630156701563010670106301c6701c630000001a0701c0701c0300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000400003f070350602b050230401d04018030140300f0300b0200802006020040200301002010020100101000010000100000000000000000000000000000000000000000000000000000000000000000000000
