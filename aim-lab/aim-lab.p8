pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
	menu_init()
	score=0
end

function menu_init()
	_update60=menu_update
	_draw=menu_draw
	poke(0x5f2d, 1)--enable cursor
	
	-- initialize mouse variables properly
	mouse_btn = 0
	mouse_btn_prev = 0
	mouse_x = 0
	mouse_y = 0
end

function menu_update()
	mouse_btn_prev = mouse_btn
	mouse_btn = stat(34)
	mouse_x = stat(32)
	mouse_y = stat(33)
	if(btnp(❎) or mouse_clicked(1))then
	 game_init()
	end
end

function menu_draw()
	cls()
	print("welcome to pico-aim",28,48,7)
	print("click or press ❎ to start!",12,68,7)
	
	draw_mouse(mouse_x,mouse_y)
	
	if(mouse_clicked(1))then
	--print("mouse 1 clicked!")--debug
	end
	--print("x:"..mouse_x.." y:"..mouse_y,0,0)--debug
end

function mouse_clicked(btn_num)
	return mouse_btn == btn_num
	 and mouse_btn_prev != btn_num
end

function draw_mouse(x,y)
	--inital sprite implementation
	--spr(1,x,y)
	circfill(x,y,1,11)
end
-->8
function game_init()
	_update60=game_update
	_draw=game_draw

	t=1500 --time
	
	poke(0x5f2d, 1)--enable cursor
	
	-- initialize mouse variables properly
	mouse_btn = 0
	mouse_btn_prev = 0
	mouse_x = 0
	mouse_y = 0
	
	targets={}
	for i=1,10 do
		make_target(rnd(119),rnd(119))
	end
end

function game_update()
	mouse_btn_prev = mouse_btn
	mouse_btn = stat(34)
	mouse_x = stat(32)
	mouse_y = stat(33)
	
	-- check for clicks on targets (do this once per frame)
	if mouse_clicked(1) then
		check_target_clicks()
	end
	
	foreach(targets,update_target)
	if(t <= 0)then
		gameover_init()
	end
	t-=1
end

function game_draw()
	cls(5)
	
	foreach(targets,draw_target)
	draw_mouse(mouse_x,mouse_y)
	
	if(mouse_clicked(1))then
		--print("mouse 1 clicked!")--debug
	end
	if(score<0)then
		print("score:"..0)
		score=0
	else
		print("score:" ..score)
	end
 --print("x:"..mouse_x.." y:"..mouse_y,0,7)--debug
	print("time:"..t,91,0)
end


function mouse_clicked(btn_num)
	return mouse_btn == btn_num
	 and mouse_btn_prev != btn_num
end

function check_target_clicks()
	for t in all(targets) do
		if 		mouse_x >= t.x-4 
			and mouse_x < 	t.x+4 
			and mouse_y >= t.y-4 
			and mouse_y < 	t.y+4 then
				del(targets,t)
				score += 10
			
				make_target((119), rnd(119))
				break -- only hit one target
		end
	end
end

function make_target(x,y)
	local t={}
	t.x=x
	t.y=y
	t.life=flr(rnd(450)+150)
	add(targets,t)
end

function update_target(t)
	t.x += rnd(0.5) - 0.25
	t.y += rnd(0.5) - 0.25
	-- remove targets that go off screen
	if(t.x < 0 or t.x > 119 
	or t.y < 0 or t.y > 119 
	or t.life <= 0) then
		del(targets,t)
		-- add a new target to replace the one that left
		make_target(rnd(119), rnd(119))
	end
	t.life-=1
end

function draw_target(t)
	--inital sprite implementation
	--spr(t.sprite,t.x,t.y)
	circfill(t.x,t.y,4,8)
	circfill(t.x,t.y,2,7)
	circfill(t.x,t.y,1,8)
end

function draw_mouse(x,y)
	--inital sprite implementation
	--spr(1,x,y)
	circfill(x,y,1,11)
end
-->8
function gameover_init()
	_update60=gameover_update
	_draw=gameover_draw
end

function gameover_update()
	if(btnp(❎) or mouse_clicked(1))then
		menu_init()
	end
end

function gameover_draw()
	cls()
	print("game over!",45,47)
	print("score:"..score,50,57)
	--print("press ❎ to restart!",27,67)
end
__gfx__
00000000000bb0000088880000000003000000003000000063363666663666636663633666666666000000000000000000000000000000000000000000000000
00000000000bb0000877778000000033000000003300000063363363663633633633633666666666000000000000000000000000000000000000000000000000
00700700000bb0008778877800000333000000003330000063366363666663663636633666666666000000000000000000000000000000000000000000000000
00077000bbb00bbb878aa87800006666000000006666000066366363663663663636636666666666000000000000000000000000000000000000000000000000
00077000bbb00bbb878aa87800066666000000006666600066366366663663636636636666666666000000000000000000000000000000000000000000000000
00700700000bb0008778877800666666033333306666660066666366633663636636666666666666000000000000000000000000000000000000000000000000
00000000000bb0000877778006666666336333636666666066363363633633633633636666666666000000000000000000000000000000000000000000000000
00000000000bb0000088880066666666366666636666666666366663633636663666636666666666000000000000000000000000000000000000000000000000
__label__
b5b55555b5b5bbb55588b7b88555bbb5bbb555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
b5b55b55b5b5b5555887b8b78b55b5b555b555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5b555555bbb5bbb55887bbb78855bbb5bbb555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
b5b55b5555b555b5588778b78b55b5b5b55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
b5b5555555b5bbb55588bbb88555bbb5bbb555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555588888885555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555888555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555588855555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555558888888555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555558877788555555555555555555555555555555
5bb55bb55bb5bbb5bbb5555555555555bb55bbb5b5b5555555555555555555555555555555555555555555555588778778855555555555555555555555555555
b555b555b5b5b5b5b5555b55555555555b5555b5b5b5555555555555555555555555555555555555555555555588788878855555555555555555555555555555
bbb5b555b5b5bb55bb5555555555bbb55b55bbb5bbb5555555555555555555555555555555555555555555555588778778855555555555555555555555555555
55b5b555b5b5b5b5b5555b55555555555b55b55555b5555555555555555555555555555555555555555555555558887788555555555555555555555555555555
bb555bb5bb55b5b5bbb5555555555555bbb5bbb555b5555555555555555555555555555555555555555555555888888888555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555887778855555555555555555555555555555555
70000000077077707070777000007770777077700000700077707770000005555555555555555555555555558877877885555555555555555555555555555555
07000000700070707070700000007070070077700000700070707070000005555555555555555555555555558878887885555555555555555555555555555555
00700000777077707070770000007770070070707770700077707700000005555555555555555555555555558877877885555555555555555555555555555555
07000000007070707770700000007070070070700000700070707070000005555555555555555555555555555887778855555555555555555555555555555555
70000000770070700700777000007070777070700000777070707770000005555555555555555555555555555888888855555555555555555555555555555555
00000000000000000000000000000000000000000000000000000000000005555555555555555555555555555558885555555555555555555555555555555555
66606660600066600000666060006660666066606600606000006660606066600660666006600000000000000000000000000000000000000000000000000000
60000600600060000000606060006060600060606060606000006000606006006000060060000000000000000000000000000000000000000000000000000000
66000600600066000000666060006600660066606060666000006600060006006660060066600000000000000000000000000000000000000000000000000000
60000600600060000000606060006060600060606060006000006000606006000060060000600000000000000000000000000000000000000000000000000000
60006660666066600000606066606060666060606660666000006660606066606600060066000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0ee0e0e0eee0eee0e0e0eee0eee0eee0eee0eee00000ee00e0e000e0ee000ee00000000000000000000000000000000000000000000000000000000000000000
e0e0e0e0e000e0e0e0e0e0e00e000e00e00000e00000e000e0e00e00e0e000e00000000000000000000000000000000000000000000000000000000000000000
e0e0e0e0ee00ee00e0e0ee000e000e00ee000ee00000e000eee00e00e0e000e00000000000000000000000000000000000000000000000000000000000000000
e0e0eee0e000e0e0eee0e0e00e000e00e00000000000e00000e00e00e0e000e00000000000000000000000000000000000000000000000000000000000000000
ee000e00eee0e0e0eee0e0e0eee00e00eee00e000000ee00eee0e000e0e00ee00000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06606660606066606600000066606660666000006000666066600000666066600000000000000000000000000000000000000000000000000000000000000000
60006060606060006060000060600600666000006000606060600000606060600000000000000000000000000000000000000000000000000000000000000000
66606660606066006060000066600600606066606000666066000000666066600000000000000000000000000000000000000000000000000000000000000000
00606060666060006060000060600600606000006000606060600000600060600000000000000000000000000000000000000000000000000000000000000000
66006060060066606660000060606660606000006660606066600600600066600000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000077077707070777000007770777077700000700077707770000077707700077088880555555555555555555555555555555555555555555555555555
07000000700070707070700000007070070077700000700070707070000070707070700088880555555555555555555555555555555555555555555555555555
00700000777077707070770000007770070070707770700077707700000077707070700088880555555555555555555555555555555555555555555555555555
07000000007070707770700000007070070070700000700070707070000070007070707088880555555555555555555555555555555555555555555555555555
70000000770070700700777000007070777070700000777070707770070070007070777088880555555555555555555555555555555555555555555555555555
00000000000000000000000000000000000000000000000000000000000000000000000000000555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555588855555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555558888888555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555558877788555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555588778778855555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555588788878855555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555588778778855555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555558877788555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555558888888555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555588855555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55588855555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
58888888555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
58877788555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
88778778855555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
88788878855555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
88778778855555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
58877788555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
58888888555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55588855555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555b5555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555bbb555555555555555555555555555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555b5555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555888555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555588888885555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555588888885555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555888888888555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555888777888555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555887787788555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555887888788555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555887787788555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555588777885555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555588888888885555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555888888888855555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555887778855555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555558885555555555555555558877877885555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555888888855555555555555558878887885555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555887778855555555555555558877877885555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555558877877885555555555555555887778855555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555558878887885555555555555555888888855555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555558877877885555555555555555558885555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555887778855555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555888888855555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555558885555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555888555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555588888885555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555588777885555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555887787788555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555887888788555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555887787788555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555588777885555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555588888885555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555888555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555

